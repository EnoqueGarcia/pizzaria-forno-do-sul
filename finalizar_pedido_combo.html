<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Finalizar Pedido</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" 
     rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="./css/style.css" />
    <style>
        .container { text-align: center; padding: 20px; }
        .pedido-form { display: inline-block; text-align: left; }
        .pedido-form label { display: block; margin-top: 15px; font-weight: bold; }
        .pedido-form input[type="text"], .pedido-form select {
            width: 300px; padding: 8px; margin-top: 5px; box-sizing: border-box; display: block;
        }
        .btn { margin: 20px auto 0; display: block; padding: 10px 25px; font-size: 16px; cursor: pointer; }
        input { outline: none; }
    </style>
</head>
<body>
<div class="container">
    <h1>Confirme seu Pedido</h1>

    <!-- Mostra o combo, descrição e preço -->
    <p><strong>Combo: <span id="combo" style="color:yellow"></span></strong></p>
    <p><strong>Descrição: <span id="descricao" style="color:rgb(230, 255, 7); font-size:1.3em;"></span></strong></p>
    <p><strong>Preço: <span id="preco" style="color:rgb(15, 233, 15); font-size:1.2em;"></span></strong></p>

    <form action="" method="POST" class="pedido-form" id="pedidoForm">

        <!-- Inputs Hidden para enviar combo -->
        <input type="hidden" name="combo" id="comboInput" />
        <input type="hidden" name="descricao" id="descricaoInput" />
        <input type="hidden" name="preco" id="precoInput" />

        <label for="nome">Nome:</label>
        <input type="text" name="nome" id="nome" required />

        <label for="endereco">Endereço:</label>
        <input type="text" name="endereco" id="endereco" required />

        <label for="telefone">Telefone:</label>
        <input type="text" name="telefone" id="telefone" required />

        <label for="pagamento">Forma de pagamento:</label>
        <select name="pagamento" id="pagamento" required>
            <option value="">Selecione</option>
            <option value="Dinheiro">Dinheiro</option>
            <option value="Cartão de Crédito">Cartão de Crédito</option>
            <option value="Cartão de Débito">Cartão de Débito</option>
            <option value="Pix">Pix</option>
        </select>

        <button type="submit" class="btn btn-danger">Finalizar Pedido</button>
    </form>
</div>

<script>
    // lê os parâmetros da URL
    const params = new URLSearchParams(window.location.search);

    // pega os dados do combo
    const combo = params.get("combo") || "";
    const descricao = params.get("descricao") || "";
    
    const preco = params.get("preco") || "";

    // mostra na tela
    document.getElementById("combo").textContent = combo;
    document.getElementById("descricao").textContent = descricao;
    document.getElementById("preco").textContent = preco ? `R$${preco}` : "";

    // preenche os inputs hidden do combo
    document.getElementById("comboInput").value = combo;
    document.getElementById("descricaoInput").value = descricao;
    document.getElementById("precoInput").value = preco;

    // intercepta o envio do formulário para mostrar SweetAlert
    document.getElementById("pedidoForm").addEventListener("submit", function(event) {
        event.preventDefault(); // impede envio imediato

        Swal.fire({
            title: "Confirmar Pedido?",
            html: `
                <b>Combo:</b> ${combo}<br>
                <b>Descrição:</b> ${descricao}<br>
                <b>Preço:</b> R$${preco}<br><br>
                <b>Nome:</b> ${document.getElementById("nome").value}<br>
                <b>Endereço:</b> ${document.getElementById("endereco").value}<br>
                <b>Telefone:</b> ${document.getElementById("telefone").value}<br>
                <b>Pagamento:</b> ${document.getElementById("pagamento").value}
            `,
            icon: "question",
            showCancelButton: true,
            confirmButtonText: "Sim, enviar",
            cancelButtonText: "Cancelar"
        }).then((result) => {
            if (result.isConfirmed) {
                // Aqui você pode enviar o formulário de verdade
                // this.submit(); // Se quiser enviar via POST ou ajustar action do form

                Swal.fire({
                    title: "Pedido realizado com sucesso!",
                    icon: "success",
                    confirmButtonText: "OK",
                });
            }
        });
    });
</script>
</body>
</html>
